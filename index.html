<!DOCTYPE html>
<html>

<head>
    <title>Battle by Beatriz Rebollo</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>



    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">


    <link rel="prefetch" href="static/music.mp3" />
    <link rel="prefetch" href="static/hit2.mp3" />
    <link rel="prefetch" href="static/enemy4.gif" />



</head>

<body>


    <style>
        * {
            font-family: 'VT323', monospace;
            text-transform: uppercase;

            -webkit-touch-callout: none;
            /* iOS Safari */
            -webkit-user-select: none;
            /* Safari */
            -khtml-user-select: none;
            /* Konqueror HTML */
            -moz-user-select: none;
            /* Old versions of Firefox */
            -ms-user-select: none;
            /* Internet Explorer/Edge */
            user-select: none;
            /* Non-prefixed version, currently
                            supported by Chrome, Edge, Opera and Firefox */
        }

        BODY {
            touch-action: pan-x pan-y;
            background: #000 url('static/background3.gif');
            background-size: 100% auto;
            width: 100%;
            height: 100%;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

        .player1 {
            background: url('static/player.png');
        }

        .player2 {
            background: url('static/player2.png');
        }

        .credits {
            text-decoration: none;
            font-size: 30px;
            color: white !important;
            z-index: 99;
        }


        @media screen and (max-width: 480px) {
            .credits {
                font-size: 24px;
            }

            body {
                background-size: 250% auto;
            }
        }
    </style>

    <a class="credits" href="https://www.artstation.com/artwork/4wKD2" target="_blank"
        style="position:fixed;left:10px;">Beatriz Rebollo</a>

    <a class="credits" href="https://twitter.com/vivirenremoto/" target="_blank"
        style="position:fixed;right:10px;">vivirenremoto</a>


    <div style="position:fixed;width:100%;height:100%;left:0;top:0;"></div>

    <div id="player" class="player1"
        style="z-index:99;background-size:100% auto;width:200px;height:367px;position:fixed;left:50%;top:50px;margin-left:-100px;">
    </div>


    <img src="static/blank.png" id="enemy"
        style="image-rendering: crisp-edges;width:480px;height:367px;position:fixed;left:0;width:100%;top:0;">



    <audio id="music" loop>
        <source src="static/music_sonic.mp3" type="audio/mp3">
    </audio>

    <audio id="sound_hit">
        <source src="static/hit2.mp3" type="audio/mp3">
    </audio>


    <script>





        var screen_height = $(document).height();
        var screen_width = $(document).width();


        var music_playing = false;
        var enemy_visible = false;

        var music = document.getElementById('music');
        music.volume = 0.5;


        var sound_hit = document.getElementById('sound_hit');


        var enemy_width = (817 * screen_height) / 802;

        var player_height = $('#player').height();


        $('#enemy').css('height', screen_height).css('width', enemy_width).css('margin-left', ((screen_width - enemy_width) / 2));







        function showEnemy() {

            var rand_delay = randomNumber(1000, 5000);

            setTimeout(function () {

                setTimeout(function () {
                    enemy_visible = true;
                }, 500);


                $('#enemy').attr('src', 'static/enemy4.gif');

            }, rand_delay);
        }

        function randomNumber(min, max) {
            if (min > max) {
                let temp = max;
                max = min;
                min = temp;
            }

            if (min <= 0) {
                return Math.floor(Math.random() * (max + Math.abs(min) + 1)) + min;
            } else {
                return Math.floor(Math.random() * (max - min + 1)) + min;
            }
        }


        $('body').click(function () {

            if (!music_playing) {
                music_playing = true;
                music.play();
            }
        });

        $('body').mousedown(function () {


            $('#player').removeClass('player1').addClass('player2');

            $('#player').stop().css('top', '50').animate({
                'top': screen_height - player_height
            }, 250, function () {

                $('#player').stop().animate({
                    'top': '50'
                }, 500);

                $('#player').removeClass('player2').addClass('player1');


                if (enemy_visible) {

                    sound_hit.currentTime = 0;
                    sound_hit.play();


                    $('#enemy').delay(300).stop().css('top', '417').animate({
                        'top': '+1000'
                    }, 500, function () {



                        $('#enemy').attr('src', 'static/blank.png').stop().animate({
                            'top': '0'
                        }, 250, function () {
                            enemy_visible = false;

                            showEnemy();


                        });

                    });
                }

            });
        });



        window.addEventListener('blur', (evt) => {
            setTimeout(function () {
                music_playing = false;
                music.pause();

            }, 500);
        });




        $(window).load(function () {
            showEnemy();
        });

    </script>

</body>

</html>